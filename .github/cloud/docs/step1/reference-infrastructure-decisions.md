# 참고 문서: 인프라 의사결정 상세

> 이 문서는 1단계 수작업 배포에서 선택한 인프라 구성의 상세 비교 분석을 담고 있습니다.

<!-- > 본문([README.md](../../../../README.md))에서는 결론만 요약하고, 상세 근거는 이 문서를 참고하세요. -->

---

## A. 온프레미스 환경 제외 이유

| 관점           | 제외 사유                                                          |
| -------------- | ------------------------------------------------------------------ |
| 선투자 비용    | 서비스 가치 검증 전 회수 불가능한 비용 발생                        |
| 실험 실패 비용 | 잘못 선택한 장비/구성이 자산으로 남아 폐기+유지 비용 동시 발생     |
| 조달 속도      | 서버 증설/교체에 수일~수주 소요, 서비스 개발 속도의 병목           |
| 운영 부담      | 하드웨어 장애, 네트워크 장애, 물리 보안 등 소규모 팀에 과도한 책임 |
| 확장성         | 초기부터 최대 부하를 가정한 설계 필요, 확장 시 구조 변경 비용이 큼 |

**결론:** 클라우드를 사용하여 초기 투자 없이 빠르게 시작하고, 필요에 따라 스케일 조정이 가능한 환경을 선택함.

---

## B. Web/API 인프라: AWS 직접 관리 vs PaaS

### B.1 비교표

| 관점          | AWS 직접 관리                 | PaaS (Vercel 등)       |
| ------------- | ----------------------------- | ---------------------- |
| 월 비용       | ~$61                          | ~$20 (Pro) + 초과 과금 |
| 커스텀        | WebSocket, 복잡한 백엔드 가능 | 제한적                 |
| 인프라 제어   | 완전 제어                     | 제한적                 |
| 관리 오버헤드 | 있음 (직접 운영)              | 없음 (위탁)            |

### B.2 PaaS vs AWS 상세 가격 비교

> 트래픽 기준: DAU ~60명, MAU ~500명, 월 ~18,000 요청

#### B.2.1 Vercel (Frontend)

| 플랜         | 월 비용 | 대역폭   | 빌드 시간 | 함수 실행        | 비고             |
| ------------ | ------- | -------- | --------- | ---------------- | ---------------- |
| Hobby (무료) | $0      | 100GB    | 100시간   | 100GB-hours      | 상업적 사용 불가 |
| **Pro**      | **$20** | 1TB      | 400시간   | 1,000GB-hours    | 상업적 사용 가능 |
| 초과 과금    | -       | $0.15/GB | $0.02/분  | $0.00016/GB-hour | -                |

**Vercel Pro 예상 비용:**

- 대역폭: 월 ~10GB (1TB 이내) → 초과 없음
- 빌드: 월 ~10시간 (400시간 이내) → 초과 없음
- **예상 비용: ~$20/월**

#### B.2.2 Railway (Backend + DB)

| 플랜    | 월 비용                               | vCPU | RAM   | 비고                         |
| ------- | ------------------------------------- | ---- | ----- | ---------------------------- |
| Hobby   | $5                                    | 공유 | 512MB | 저사양, 슬립 발생            |
| **Pro** | **$20**                               | -    | -     | $20 크레딧 포함, 초과분 과금 |
| 사용량  | $0.000463/vCPU-min + $0.000232/GB-min | -    | -     | 리소스 기반                  |

**Vercel + Railway 예상 비용 (Backend + DB만 Railway):**

> Spring Boot 1 vCPU, 2GB 기준 (서비스 분리로 경합 없음)

- vCPU: 1 × $0.000463 × 60 × 24 × 30 = ~$20/월
- RAM: 2 × $0.000232 × 60 × 24 × 30 = ~$20/월
- **예상 비용: ~$40/월** (Pro 포함 시 ~$60/월) + Vercel Pro $20 = **~$80/월**

#### B.2.3 Railway Only (Frontend + Backend + DB)

> 서비스 분리 시 리소스 경합이 없으므로 단일 인스턴스보다 낮은 스펙 가능

| 서비스          | 예상 리소스   | 월 비용     | 비고                |
| --------------- | ------------- | ----------- | ------------------- |
| Pro 플랜        | -             | $20         | $20 크레딧 포함     |
| **Spring Boot** | 1 vCPU, 2GB   | ~$40        | Backend (경합 없음) |
| **Next.js**     | 0.5 vCPU, 1GB | ~$20        | Frontend (SSR 경량) |
| **PostgreSQL**  | 사용량 기반   | ~$5~10      | DB                  |
| **총계**        | -             | **~$85~90** | -                   |

**Railway Only 예상 비용 계산:**

- Pro 플랜: $20 (크레딧 $20 포함)
- Backend (Spring Boot): 1 vCPU ~$20 + 2GB RAM ~$20 = ~$40
- Frontend (Next.js): 0.5 vCPU ~$10 + 1GB RAM ~$10 = ~$20
- PostgreSQL: 사용량 기반 ~$5~10
- **총계: ~$85~90/월** (크레딧 적용 전 기준)

**스펙 산정 근거:**

- Spring Boot: `-Xmx1g` 힙 + 네이티브 ~500MB = ~1.5GB → 2GB면 충분
- Next.js SSR은 경량 작업, 0.5 vCPU + 1GB로 피크 대응 가능
- QPS 0.17 피크에서 1 vCPU로 200+ RPS 처리 가능

**Railway 제약사항:**

- 각 서비스가 **별도 도메인**으로 노출 (`*.up.railway.app`)
- 단일 도메인 라우팅 불가 (AWS Nginx처럼 `/api/*` → Backend 불가)
- CORS 설정 필수 (프론트엔드 ↔ 백엔드 간)
- 단일 도메인 필요 시 Nginx 컨테이너 추가 → 비용 증가

#### B.2.4 비용 비교 종합

| 옵션                 | 구성                                    | 월 비용     | 스펙        | 비고                     |
| -------------------- | --------------------------------------- | ----------- | ----------- | ------------------------ |
| **AWS (Option A)**   | t4g.large (2 vCPU, 8GB) + gp3 100GB     | **~$61**    | 충분        | 완전 제어, 단일 도메인   |
| **Vercel + Railway** | Vercel Pro + Railway Pro (Backend + DB) | **~$80**    | 분리 최적화 | Frontend/Backend 분리    |
| **Railway Only**     | Next.js + Spring Boot + PostgreSQL      | **~$85~90** | 분리 최적화 | 단일 플랫폼, 별도 도메인 |

**핵심 비교:**

| 항목          | AWS (~$61)           | Railway (~$85~90)      |
| ------------- | -------------------- | ---------------------- |
| **RAM**       | 8GB (충분)           | 3GB (분리, 충분)       |
| **CPU**       | 2 vCPU (버스트 가능) | 1.5 vCPU (분리, 충분)  |
| **DB**        | 자체 PostgreSQL      | Railway PostgreSQL     |
| **도메인**    | 단일 도메인 (Nginx)  | 서비스별 별도 도메인   |
| **유연성**    | 완전 제어            | 플랫폼 제약            |
| **WebSocket** | 자유롭게 구현        | 지원                   |
| **학습 곡선** | 있음                 | 낮음                   |
| **비용 효율** | 고정 비용, 저렴      | 사용량 비례, ~40% 비쌈 |

### B.3 AWS 직접 관리 선택 이유

1. **팀 역량**: 인프라 엔지니어가 있어 직접 관리 시 비용 최적화 가능
2. **기능 요구사항**: WebSocket, 백그라운드 작업 등 PaaS 한계 예상
3. **레퍼런스**: AWS 레퍼런스가 압도적으로 많아 문제 해결 속도 빠름
4. **비용 효율**: 동일 스펙 기준 AWS가 PaaS 대비 저렴하거나 동등하면서 유연성 확보

### B.4 핵심 원칙

> "직접 관리 가능하면 직접 관리, 비용 차이가 압도적이면 외부 서비스 활용"

---

## C. GPU 인프라: AWS GPU vs RunPod vs 외부 API

### C.1 비교표

| 관점              | AWS GPU (g4dn.xlarge)  | RunPod Active               | 외부 API (OpenAI 등) |
| ----------------- | ---------------------- | --------------------------- | -------------------- |
| 월 비용           | ~$380 (24/7 상시 가동) | **~$50~100** (상시 가동)    | ~$15~50              |
| 사용 패턴         | 상시 가동만 가능       | Serverless + 상시 가동 선택 | Serverless           |
| 커스텀 모델       | 가능                   | 가능                        | 불가                 |
| 데이터 프라이버시 | 자체 인프라            | 자체 인프라                 | 외부 전송            |

### C.2 AWS GPU가 비싼 핵심 이유

AWS는 GPU Serverless 옵션이 없음. EC2 GPU 인스턴스는 24/7 상시 가동만 가능하여 비효율적.

### C.3 RunPod 선택 이유

1. **커스텀 모델 필수** - 우리 모델의 신뢰도/성능을 검증하는 것이 목표
2. **데이터 보안** - 영수증 등 민감 데이터 외부 API 미전송
3. **유연한 과금** - Flex(사용량 기반) / Active(상시 가동) 선택 가능
4. **비용 효율** - AWS GPU 대비 70~80% 저렴

### C.4 RunPod 가격 상세 (L4 24GB GPU 기준)

> 출처: [RunPod 공식 가격 페이지](https://www.runpod.io/pricing)

| 타입          | 초당 가격 | 시간당 환산 | 월 비용 (24/7)   | 특징                             |
| ------------- | --------- | ----------- | ---------------- | -------------------------------- |
| Flex Worker   | $0.00019  | ~$0.68      | ~$1~5 (저트래픽) | 사용 시만 과금, 콜드 스타트 있음 |
| Active Worker | $0.00013  | ~$0.47      | **~$343**        | 24/7 상시 가동, 최대 30% 할인    |

### C.5 단계 결정: Active Worker (단기)

| 항목      | 결정                                  |
| --------- | ------------------------------------- |
| 운영 방식 | Active Worker (Min=1)                 |
| 월 비용   | **~$343** (예산의 5배)                |
| 운영 기간 | **1~2주 (검증 기간만)**               |
| 선택 이유 | 콜드 스타트 제거, 데모/런칭 품질 확보 |

**왜 외부 API가 아닌 우리 모델인가?**

> "외부 API가 잘 나오냐"가 아니라, **우리 모델의 신뢰도/성능이 실제 사용자 입력에서 어느 정도인지 검증하는 것**이다.

- 외부 API로 대체하면 검증 대상이 바뀜
- 모델을 이미 만들었고, 지금 단계의 목적은 **우리 모델 품질/실패 패턴 수집**

### C.6 비용 최적화 로드맵 (운영 단계)

검증 후 월 10만 원 예산에 맞추기 위한 개선 방향:

| 방안                   | 설명                                             | 예상 비용      |
| ---------------------- | ------------------------------------------------ | -------------- |
| **Flex (사용량 기반)** | 실제 추론 시간만 과금, 콜드 스타트 30초~2분 감수 | **~$3~10/월**  |
| 샘플링 기반 운용       | 5~10% 요청만 모델로 처리                         | ~$10~30        |
| 비동기 처리            | "분석 중" 흐름으로 전환                          | 피크 부담 감소 |
| 외부 API 보완          | 벤치마크/폴백 용도로만                           | 장애 시 안전망 |

**전환 시점:** 검증 완료 후 1~2주 내

> 상세: [RunPod 배포 방식 상세](./reference-runpod-deployment-methods.md#gpu-운영-전략-및-의사결정)

---

## D. EC2 아키텍처 대안 비교

### D.1 Option 정의

| Option | 구성                                                     |
| ------ | -------------------------------------------------------- |
| A      | 단일 EC2 (현재 선택)                                     |
| B      | 서비스 분리 (Public Subnet) - EC2 2대 + RDS (pgvector)   |
| C      | 서비스 분리 + Private Subnet - EC2 2대 + RDS + ALB + NAT |

> **참고:** 벡터 검색은 PostgreSQL의 pgvector 확장을 사용하여 RDS에 통합. 별도 벡터 DB 불필요.

### D.2 비용 비교표

| 구성 요소      | Option A (단일) | Option B (분리)   | Option C (분리+Private) |
| -------------- | --------------- | ----------------- | ----------------------- |
| EC2 Frontend   | -               | t4g.small ~$12    | t4g.small ~$12          |
| EC2 Backend    | -               | t4g.small ~$12    | t4g.small ~$12          |
| RDS PostgreSQL | -               | db.t4g.micro ~$15 | db.t4g.micro ~$15       |
| EC2 (통합)     | t4g.large ~$49  | -                 | -                       |
| EBS            | gp3 100GB ~$11  | gp3 20GB x2 ~$5   | gp3 20GB x2 ~$5         |
| ALB            | -               | -                 | ~$18                    |
| NAT Gateway    | -               | -                 | ~$35                    |
| 데이터 전송    | ~$1             | ~$3               | ~$5                     |
| **월 총계**    | **~$61**        | **~$47**          | **~$102**               |

### D.3 종합 비교

| 항목          | Option A | Option B   | Option C      |
| ------------- | -------- | ---------- | ------------- |
| 월 비용       | ~$61     | ~$47       | ~$102         |
| 관리 복잡도   | 낮음     | 중간       | 높음          |
| 보안 수준     | 보안그룹 | 보안그룹   | 네트워크 격리 |
| 장애 격리     | 없음     | 있음       | 있음          |
| 개별 스케일링 | 불가     | 가능       | 가능          |
| 배포 복잡도   | 단순     | CI/CD 필요 | CI/CD 필요    |

### D.4 Option A 선택 이유

- DAU 60명 수준에서 장애 격리/개별 스케일링 필요성 낮음
- 관리 포인트 최소화 (EC2 1대만 관리)
- Option B가 약간 저렴하나 ($14 차이), 서비스 3개 관리 오버헤드 발생
- 트래픽 증가 시 Option B/C로 전환 고려

---

## E. 인스턴스 선정 및 예상 비용

### E.1 예상 트래픽 규모

트래픽 산정 근거:

| 항목        | 예상치       | 산정 근거                |
| ----------- | ------------ | ------------------------ |
| MAU         | ~500명       | 초기 목표 사용자         |
| DAU         | ~60명        | MAU의 12%                |
| 동시접속    | 3~6명        | DAU의 5~10%              |
| 일일 요청량 | ~600 req/day | 사용자당 평균 10 req/day |

**QPS (초당 요청 수) 계산 - 식사 시간 피크 기준:**

> 서비스 특성: 점심/저녁 식사 후 음식점 방문 → 영수증 OCR로 정산 요청 집중

| 시나리오                          | 계산           | QPS       |
| --------------------------------- | -------------- | --------- |
| 균등 분포 (비현실적)              | 600 ÷ 86,400초 | 0.007     |
| 4시간 70% 집중                    | 420 ÷ 14,400초 | 0.03      |
| **2시간 80% 집중 (점심+저녁)**    | 480 ÷ 7,200초  | **0.067** |
| **30분 50% 스파이크 (식후 직후)** | 300 ÷ 1,800초  | **0.17**  |

> DAU 60명, 극단적 피크에서도 QPS < 0.2 수준의 저트래픽 환경.

### E.2 인스턴스 선정: t4g.large

| 인스턴스 타입 | vCPU | RAM | 서울 리전 시간당 가격 | 월간 비용 (730h) |
| ------------- | ---- | --- | --------------------- | ---------------- |
| **t4g.large** | 2    | 8GB | $0.0672               | **~$49**         |

**구성 요소별 예상 리소스 사용량 (8GB 기준):**

| 구성 요소   | 예상 RAM    | 예상 CPU | 특성         | 비고                                |
| ----------- | ----------- | -------- | ------------ | ----------------------------------- |
| PostgreSQL  | ~2GB        | 5~15%    | I/O Bound    | shared_buffers 512MB + OS 캐시 활용 |
| Spring Boot | ~1.5GB      | 10~20%   | Memory Bound | -Xmx1g + 네이티브 ~500MB            |
| Next.js     | ~700MB      | 5~10%    | Memory Bound | max_memory_restart: 850M            |
| Nginx       | ~150MB      | < 1%     | -            | 리버스 프록시, TLS 처리             |
| OS/시스템   | ~1GB        | 5%       | -            | 시스템 프로세스, 로깅               |
| **합계**    | **~5.35GB** | **~40%** |              | **여유 ~2.65GB**                    |

**pgvector 영향:**

- 예상 벡터 수: ~1,400개 (768차원 기준)
- 메모리 사용: ~5.6MB (무시 가능)
- 인덱스 포함해도 PostgreSQL 2GB 내에서 충분

**OS 페이지 캐시 활용:**

- Linux는 여유 메모리를 자동으로 디스크 캐시로 활용
- PostgreSQL이 동일 데이터 재조회 시 OS 캐시에서 읽어 성능 향상
- 여유 2.65GB가 OS 캐시로 활용되어 DB 성능에 기여

### E.3 인스턴스 타입 비교

#### E.3.1 버스터블(t4g) vs 고정 성능(m6g) 인스턴스

| 인스턴스      | 타입     | vCPU | RAM | 월 비용 | CPU 특성                               |
| ------------- | -------- | ---- | --- | ------- | -------------------------------------- |
| **t4g.large** | 버스터블 | 2    | 8GB | ~$49    | 평상시 20% 기준선, 피크 시 100% 버스트 |
| m6g.large     | 고정     | 2    | 8GB | ~$70    | 항상 100% 사용 가능                    |
| m7g.large     | 고정     | 2    | 8GB | ~$75    | 항상 100% 사용 가능                    |

**버스터블 인스턴스 선택 이유:**

1. **트래픽 패턴에 적합**

   - DAU 60명, QPS < 1 → 대부분 유휴 상태, 간헐적 피크
   - 평균 CPU 20% 이하 유지 → 크레딧 축적 → 피크 시 버스트 가능
   - 서비스 특성상 특정 시간대에 트래픽 집중 예상

2. **비용 효율**
   - 고정 성능(m6g) 대비 약 30% 저렴
   - 트래픽 패턴에 따라 유연한 리소스 사용 가능

**버스터블 인스턴스 위험 요소:**

- 지속적으로 CPU 20% 초과 시 → 크레딧 고갈 → 성능 급락
- 예측 불가능한 트래픽 스파이크 시 대응 어려움

> 저트래픽 환경에서는 버스터블이 비용 효율적. 트래픽 증가 시 고정 성능으로 전환 검토.

#### E.3.2 더 낮은 스펙 검토 (t4g.medium vs t4g.large)

| 인스턴스      | vCPU | RAM  | 월 비용 | 예상 메모리 사용 | 여유     |
| ------------- | ---- | ---- | ------- | ---------------- | -------- |
| t4g.medium    | 2    | 4GB  | ~$24    | ~5.35GB          | OOM 발생 |
| **t4g.large** | 2    | 8GB  | ~$49    | ~5.35GB          | ~2.65GB  |
| t4g.xlarge    | 4    | 16GB | ~$98    | ~5.35GB          | 오버스펙 |

**t4g.large (8GB) 선택 이유:**

1. **MVP에 적합한 비용 효율**

   - 현재 예상 사용량 ~5.35GB, 여유 ~2.65GB로 운영 가능
   - t4g.xlarge 대비 월 $49 절감 (~50% 비용 절감)

2. **여유 메모리의 역할**

   - ~2.65GB 여유 → OS 페이지 캐시로 활용 → DB 성능 향상
   - 스왑 미설정으로 OOM 시 빠른 재시작 (Fail Fast 원칙)

#### E.3.3 단일 인스턴스 처리 용량 (QPS/RPS) 분석

<!-- > 출처: [Spring Boot Benchmark](https://dev.to/azure/spring-boot-performance-benchmarks-with-tomcat-undertow-and-webflux-4d8k), [Spring Boot vs Quarkus](https://medium.com/arconsis/spring-boot-vs-quarkus-part-2-jvm-runtime-performance-af45d0db116e), [PostgreSQL Millions QPS](https://www.percona.com/blog/millions-queries-per-second-postgresql-and-mysql-peaceful-battle-at-modern-demanding-workloads/) -->

**⚠️ 단일 인스턴스 특성:**

- PostgreSQL + Spring Boot + Next.js가 **동일 EC2에서 리소스 경쟁**
- 벤치마크 수치(서비스 분리 기준)보다 **보수적으로** 산정 필요

**Spring Boot 처리 용량 (2 vCPU, 서비스 분리 시):**

| 워크로드 유형            | 예상 RPS    | 병목 지점 | 비고           |
| ------------------------ | ----------- | --------- | -------------- |
| 단순 REST (Hello World)  | 2,000~3,000 | CPU       | 최적화된 경우  |
| **DB 쿼리 포함**         | **200~800** | DB I/O    | 일반적인 CRUD  |
| I/O 집약 (외부 API 호출) | 100~400     | 네트워크  | RunPod 호출 등 |

> **참고:** Spring Boot + Tomcat 기본 스레드 풀 200개. 요청당 1초 소요 시 최대 200 RPS.

**PostgreSQL 처리 용량 (서비스 분리 시):**

| 워크로드 유형 | 예상 QPS        | 조건                   |
| ------------- | --------------- | ---------------------- |
| 단순 SELECT   | 5,000~10,000+   | 인덱스 사용, 캐시 히트 |
| **CRUD 혼합** | **1,000~3,000** | 인덱스 최적화          |
| 복잡한 JOIN   | 100~500         | 쿼리 최적화 필요       |

**예상 단일 인스턴스 처리 용량**

| 인스턴스       | vCPU | RAM  | 예상 RPS        | 산정 근거                         |
| -------------- | ---- | ---- | --------------- | --------------------------------- |
| **t4g.large**  | 2    | 8GB  | **50~150 RPS**  | DB 경합(÷2) × Next.js 경합(÷1.5)  |
| **t4g.xlarge** | 4    | 16GB | **150~350 RPS** | 2배 CPU + 메모리 여유로 경합 완화 |

> **계산:** Spring Boot 200~800 RPS ÷ 2 (PostgreSQL 경합) ÷ 1.5 (Next.js 경합) ≈ 67~267 → 보수적으로 **50~150 RPS**

**t4g.large 한계 요인:**

1. **리소스 경합**: PostgreSQL, Spring Boot, Next.js가 2 vCPU + 8GB 공유
2. **CPU 버스트 제한**: 지속적 고부하 시 크레딧 고갈 → 20% 기준선으로 하락
3. **메모리 압박**: 여유 ~2.65GB로 OS 캐시 제한적

**t4g.xlarge 이점:**

1. **CPU 2배**: 4 vCPU로 경합 완화
2. **메모리 2배**: 16GB로 DB 캐시 + 힙 확장 가능
3. **Blue-Green 배포 가능**: 메모리 여유로 무중단 배포

**현재 vs 처리 용량 (식사 시간 피크 기준):**

| 시나리오              | 피크 QPS | t4g.large 용량 | 여유율             |
| --------------------- | -------- | -------------- | ------------------ |
| 2시간 80% 집중        | 0.067    | 50~150 RPS     | **~750배~2,200배** |
| **30분 50% 스파이크** | **0.17** | 50~150 RPS     | **~300배~900배**   |
| 동시접속              | 3~6명    | ~200명         | **~33배~67배**     |

> **결론:** 식후 30분 스파이크(0.17 QPS)에서도 t4g.large는 **수백 배 여유**가 있음.
> 스케일업 검토 시점: **QPS 30+ 지속** 또는 **CPU 크레딧 20% 미만**

**t4g.large 선택에 따른 제약:**

- 단일 인스턴스 Blue-Green 배포 불가 (메모리 부족)
- Big Bang 배포 방식 사용 (약 8분 다운타임 발생)

### E.4 선정 근거 요약

1. **RAM 8GB 선택**

   - 예상 사용량 ~5.35GB, 여유분 ~2.65GB 확보
   - 여유 메모리는 OS 페이지 캐시로 활용 → DB 성능 향상
   - 스왑 미설정 (OOM 발생 시 프로세스 종료로 빠른 문제 인지)

2. **CPU 버스트 크레딧 유지 가능**

   - DAU 60명, QPS < 1 기준 평균 CPU 사용률 ~20% 이하
   - t4g.large 기준선: 20% (이하면 크레딧 축적)
   - 피크 시에만 버스트, 평상시 크레딧 회복

3. **Graviton2(ARM) 가성비**

   - 동일 스펙 x86 대비 약 20% 저렴
   - Node.js, Java, PostgreSQL 모두 ARM 호환

### E.5 스토리지 선정: gp3 100GB

| 항목     | 사양         | 월 비용 |
| -------- | ------------ | ------- |
| 스토리지 | 100GB        | ~$11.4  |
| IOPS     | 3,000 (기본) | $0      |

### E.6 총 예상 비용 (월간)

| 항목         | 사양            | 월 비용     |
| ------------ | --------------- | ----------- |
| EC2 인스턴스 | t4g.large       | ~$49        |
| EBS 스토리지 | gp3 100GB       | ~$11        |
| 데이터 전송  | 10GB 아웃바운드 | ~$1         |
| **총계**     |                 | **~$61/월** |

### E.7 GPU 서버 (RunPod Serverless)

| 항목          | 값                          |
| ------------- | --------------------------- |
| 모델          | Qwen/Qwen2.5-VL-7B-Instruct |
| 모델 유형     | Vision-Language Model (VLM) |
| 추론 엔진     | vLLM                        |
| GPU           | L4 24GB (Active Worker)     |
| **월간 비용** | **~$343** (24/7 상시 구동)  |

**단계 결정:**

- Active (Min=1) 상시 구동으로 콜드 스타트 제거
- 목표: 우리 모델의 신뢰도/실패 패턴을 실제 입력에서 검증
- **리스크:** 월 ~$343는 예산(~$70)의 5배

<!-- > **참고:** 자체 VLM vs 외부 Vision API 비용 비교는 [RunPod 배포 방식 상세 - VLM 비용 비교](./reference-runpod-deployment-methods.md#자체-vlm-vs-외부-vision-api-비용-비교) 참고

> **상세:** GPU 운영 전략 및 향후 개선 방향은 [RunPod 배포 방식 상세](./reference-runpod-deployment-methods.md#gpu-운영-전략-및-의사결정) 참고 -->

### E.8 인프라 선택 요약

| 워크로드          | 선택              | 선택 이유                       |
| ----------------- | ----------------- | ------------------------------- |
| **Web/API**       | AWS EC2 직접 관리 | 팀 역량 활용, 비용 최적화       |
| **GPU (AI 추론)** | RunPod Serverless | 저트래픽에서 압도적 비용 효율성 |

---

## F. 스케일업 전략

### F.1 스케일업 임계값

| 지표              | 경고 (모니터링 강화)  | 스케일업 검토         | 측정 방법                   |
| ----------------- | --------------------- | --------------------- | --------------------------- |
| **CPU 크레딧**    | 잔여 < 30%            | 잔여 < 20%            | CloudWatch CPUCreditBalance |
| **CPU 사용률**    | 평균 60% 초과 (1주일) | 평균 70% 초과 (1주일) | CloudWatch CPUUtilization   |
| **메모리 사용률** | 70% 초과 지속         | 80% 초과 지속         | CloudWatch Agent 또는 htop  |
| **응답 시간**     | p95 > 300ms           | p95 > 500ms 지속      | Application 로그            |
| **DB 커넥션**     | 70% 초과              | 80% 초과              | PostgreSQL pg_stat_activity |

### F.2 스케일업 경로

| 단계      | 조건                             | 현재 → 변경                         | 월 비용 변화  |
| --------- | -------------------------------- | ----------------------------------- | ------------- |
| **0단계** | DAU ~60                          | t4g.large (현재)                    | ~$61          |
| **1단계** | 메모리 부족 또는 Blue-Green 필요 | t4g.large → t4g.xlarge (16GB)       | ~$61 → ~$110  |
| **2단계** | CPU 크레딧 부족                  | t4g.xlarge → m6g.xlarge (고정 성능) | ~$110 → ~$140 |
| **3단계** | DAU 500+                         | 단일 EC2 → Option B (서비스 분리)   | 구조 변경     |

<!-- ---

## 참고 링크

- [AWS EC2 요금](https://aws.amazon.com/ec2/pricing/)
- [RunPod Serverless 요금](https://docs.runpod.io/serverless/pricing)
- [AWS RDS 요금](https://aws.amazon.com/rds/pricing/)
- [AWS t4g 버스트 크레딧 설명](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-credits-baseline-concepts.html) -->
