# SEC-001: DB 크레덴셜 외부 유출 및 7시간 연쇄 장애

| 항목 | 내용 |
|------|------|
| 날짜 | 2026-02-02 |
| 심각도 | Critical |
| 적용 단계 | v1 (Big Bang) |
| 관련 문서 | [DR-003 로그 모니터링 구축](../architecture/DR-003-monitoring-setup.md), [SEC-002 (DoS 대응)](SEC-002-dos-attack-and-security-hardening.md) |
| GitHub Issue | #79 |
| 주요 목표 | 크레덴셜 유출 경위 파악, 대응 과정 기록, 재발 방지 체계 수립 |

---

## 1) 사고 개요

GitHub Public Wiki에 DB 비밀번호와 VPN 키가 노출되었다. 외부 공격자가 이를 이용해 DB 접속을 시도했으나 PostgreSQL 권한 설정으로 직접 피해는 없었다. 그러나 크레덴셜 교체 과정에서 2차 장애가 발생하여 서비스가 7시간 동안 중단되었다.

---

## 2) 타임라인

1단계 - 발견: Wiki에 DB 비밀번호와 VPN 키가 노출된 사실을 발견
2단계 - 즉시 차단: 보안 그룹에서 VPN 접속 차단, 담당자에게 알림
3단계 - 크레덴셜 교체: 담당자가 확인 후 DB 비밀번호 및 VPN 키 교체
4단계 - 연쇄 장애: DB 비밀번호를 변경했지만 백엔드 환경변수(`env.conf`)를 함께 갱신하지 않음
5단계 - 서비스 중단: Spring Boot가 DB 연결 실패로 무한 재시작 → 7시간 동안 서비스 불가

---

## 3) 근본 원인 분석

직접 원인: Wiki가 Public 설정인 줄 모르고 운영 크레덴셜을 기록함

연쇄 장애 원인:
- 환경변수가 서버 내 파일(`env.conf`)로 관리되어, DB 비밀번호 변경 시 어디를 함께 바꿔야 하는지 체크리스트가 없었음
- 모니터링 시스템이 없어서 백엔드가 죽은 걸 7시간 동안 모름
- 알림 체계 부재 — 서비스 상태를 수동으로 확인하는 것에 의존

---

## 4) 대응 조치

즉시 조치:
- 유출된 모든 크레덴셜 교체 (DB, VPN, IAM 키)
- Wiki를 Private으로 전환
- Git 히스토리에서 민감 정보 퍼지

도출된 과제 (이 사고가 트리거가 됨):
- 모니터링 시스템 구축 필요 → [PLG Stack 도입](../architecture/DR-003-monitoring-setup.md)으로 이어짐
- 서비스 헬스체크 알림 체계 필요
- 크레덴셜 관리 표준화 (장기: AWS Parameter Store 전환)
- 환경변수 변경 시 영향 범위 체크리스트 작성

---

## 5) 교훈

이 사고는 단순한 비밀번호 유출이 아니라, "인프라 운영에 관측 가능성(Observability)이 없으면 사소한 실수가 장시간 장애로 이어진다"는 것을 보여준 사건이었다. 비밀번호 유출 자체는 PostgreSQL 권한으로 막혔지만, 대응 과정에서 발생한 2차 장애가 오히려 더 큰 피해를 만들었다.

이 사고 직후 [PLG Stack 기반 로그 모니터링 시스템 구축](../architecture/DR-003-monitoring-setup.md)이 시작되었다.
